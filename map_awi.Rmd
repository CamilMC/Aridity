---
title: "Maps AWI"
output: 
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    code_folding: hide
date: "2023-12-13"
bibliography: AI.bib

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, error = FALSE, fig.align = "center", collapse = T)
```

```{r libraries}
library(raster)
library(dplyr)
library(ggplot2)
library(viridisLite)
library(sf)
library(stringr)
```

```{r masks}
cmcc <- raster("/bettik/crapartc/CMIP6/ts/ts_Amon_CMCC-CM2-SR5_historical_r1i1p1f1_gn_185001-201412.nc")
crs(cmcc) <- "EPSG:4326"
cmcc.df <- as.data.frame(ex_raster, xy = T)

land_mask <- raster("Aridity/Masks/land_sea_mask_1degree.nc4") 
extent(land_mask) <- extent(cmcc)
land_mask <-  projectRaster(from = land_mask, to = cmcc)
land_mask.df <- as.data.frame(land_mask, xy = T) %>% setNames(c("lon","lat","lm")) # 0 if ocean, 1 if land

ipcc_regions <- shapefile("Aridity/Masks/IPCC-WGI-reference-regions-v4.shp") %>% spTransform(crs("EPSG:4326")) 
ipcc_regions.raster <- ipcc_regions %>% rasterize(cmcc)
ipcc_regions.df <- as.data.frame(ipcc_regions.raster, xy = T) %>% setNames(c("lon","lat","Continent","Type","Name","Acronym"))
#ipcc_regions.sf <- st_as_sf(ipcc_regions.raster)
```

```{r awi-annual-dfs}
awi_annual <- merge(read.table("/bettik/crapartc/Averages/ts/awi.hist.1850-1880.ts.txt"), read.table("/bettik/crapartc/Averages/ts/awi.hist.1985-2015.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2030-2060.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2070-2100.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2030-2060.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2070-2100.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2030-2060.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2070-2100.ts.txt"), by = c("lon", "lat")) %>%
setNames(c("lon", "lat", "hist_1850_1880", "hist_1985_2015","ssp245_2030_2060","ssp245_2070_2100","ssp370_2030_2060","ssp370_2070_2100","ssp585_2030_2060","ssp585_2070_2100"))

awi_land <- merge(awi_annual, land_mask.df, by = c("lon", "lat")) 
awi_ipcc <- merge(awi_land, ipcc_regions.df, by = c("lon", "lat"))
ggplot(awi_ipcc)+geom_raster(aes(x=lon, y =lat, fill = ssp245_2070_2100 - hist_1985_2015))+

awi_regions <- awi_ipcc %>% group_by(Name, Acronym, Continent) %>% 
  summarise(hist_1850_1880 = mean(hist_1850_1880, na.rm = T), hist_1985_2015 = mean(hist_1985_2015, na.rm = T), ssp245_2030_2060 = mean(ssp245_2030_2060, na.rm = T), ssp245_2070_2100 = mean(ssp245_2070_2100, na.rm = T), ssp370_2030_2060 = mean(ssp370_2030_2060, na.rm = T), ssp370_2070_2100 = mean(ssp370_2070_2100, na.rm = T), ssp585_2030_2060 = mean(ssp585_2030_2060, na.rm = T), ssp585_2070_2100 = mean(ssp585_2070_2100, na.rm = T)) %>%
  as.data.frame()
head(awi_regions)

ggplot(data = awi_regions, aes(x = hist_1985_2015)) + geom_point(aes(y = ssp245_2070_2100, col = Continent))+
  geom_abline(slope = 1, intercept = 0)

write.table(awi_ipcc, "/bettik/crapartc/Averages/ts/awi.ts_ipcc.txt")

```

```{r awi-annual-long}
awi_annual <- rbind(mutate(read.table("/bettik/crapartc/Averages/ts/awi.hist.1850-1880.ts.txt"), model = "historical", period = "1850_1880"),mutate(read.table("/bettik/crapartc/Averages/ts/awi.hist.1985-2015.ts.txt"), model = "historical", period = "1985_2015")) %>%
rbind(mutate(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2030-2060.ts.txt"), model = "SSP245", period = "2030_2060")) %>%
rbind(mutate(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2070-2100.ts.txt"), model = "SSP245", period = "2070_2100")) %>%
rbind(mutate(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2030-2060.ts.txt"), model = "SSP370", period = "2030_2060")) %>%
rbind(mutate(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2070-2100.ts.txt"), model = "SSP370", period = "2070_2100")) %>%
rbind(mutate(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2030-2060.ts.txt"), model = "SSP585", period = "2030_2060")) %>%
rbind(mutate(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2070-2100.ts.txt"), model = "SSP585", period = "2070_2100"))

ggplot(awi_annual)+geom_boxplot(aes(x = period, y = ts, col = model))+scale_color_viridis_d()

awi_land <- merge(awi_annual, land_mask.df, by = c("lon", "lat")) 
awi_ipcc <- merge(awi_land, ipcc_regions.df, by = c("lon", "lat"))
ggplot(awi_ipcc)+geom_raster(aes(x=lon, y =lat, fill = ssp245_2070_2100 - hist_1985_2015))+

awi_regions <- awi_ipcc %>% group_by(Name, Acronym, Continent) %>% 
  summarise(hist_1850_1880 = mean(hist_1850_1880, na.rm = T), hist_1985_2015 = mean(hist_1985_2015, na.rm = T), ssp245_2030_2060 = mean(ssp245_2030_2060, na.rm = T), ssp245_2070_2100 = mean(ssp245_2070_2100, na.rm = T), ssp370_2030_2060 = mean(ssp370_2030_2060, na.rm = T), ssp370_2070_2100 = mean(ssp370_2070_2100, na.rm = T), ssp585_2030_2060 = mean(ssp585_2030_2060, na.rm = T), ssp585_2070_2100 = mean(ssp585_2070_2100, na.rm = T)) %>%
  as.data.frame()
head(awi_regions)

ggplot(data = awi_regions, aes(x = hist_1985_2015)) + geom_point(aes(y = ssp245_2070_2100, col = Continent))+
  geom_abline(slope = 1, intercept = 0)

write.table(awi_ipcc, "/bettik/crapartc/Averages/ts/awi.ts_ipcc.txt")

```

```{r awi-jan-dfs}
awi_jan <- merge(read.table("/bettik/crapartc/Averages/ts/awi.hist.1850-1880.jan.ts.txt"), read.table("/bettik/crapartc/Averages/ts/awi.hist.1985-2015.jan.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2030-2060.jan.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2070-2100.jan.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2030-2060.jan.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2070-2100.jan.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2030-2060.jan.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2070-2100.jan.ts.txt"), by = c("lon", "lat")) %>%
setNames(c("lon", "lat", "hist_1850_1880", "hist_1985_2015","ssp245_2030_2060","ssp245_2070_2100","ssp370_2030_2060","ssp370_2070_2100","ssp585_2030_2060","ssp585_2070_2100"))
awi_jan_land <- merge(awi_jan, land_mask.df, by = c("lon","lat")) 
awi_jan_ipcc <- merge(awi_jan_land, ipcc_regions.df, by = c("lon","lat"))

write.table(awi_jan_ipcc, "Averages/ts/awi.jan.ts_ipcc.txt")
```

```{r awi-fev-dfs}
awi_fev <- merge(read.table("/bettik/crapartc/Averages/ts/awi.hist.1850-1880.fev.ts.txt"), read.table("/bettik/crapartc/Averages/ts/awi.hist.1985-2015.fev.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2030-2060.fev.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2070-2100.fev.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2030-2060.fev.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2070-2100.fev.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2030-2060.fev.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2070-2100.fev.ts.txt"), by = c("lon", "lat")) %>%
setNames(c("lon", "lat", "hist_1850_1880", "hist_1985_2015","ssp245_2030_2060","ssp245_2070_2100","ssp370_2030_2060","ssp370_2070_2100","ssp585_2030_2060","ssp585_2070_2100"))
awi_fev_land <- merge(awi_fev, land_mask.df, by = c("lon","lat")) 
awi_fev_ipcc <- merge(awi_fev_land, ipcc_regions.df, by = c("lon","lat"))

write.table(awi_fev_ipcc, "Averages/ts/awi.fev.ts_ipcc.txt")
```

```{r awi-mar-dfs}
awi_mar <- merge(read.table("/bettik/crapartc/Averages/ts/awi.hist.1850-1880.mar.ts.txt"), read.table("/bettik/crapartc/Averages/ts/awi.hist.1985-2015.mar.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2030-2060.mar.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2070-2100.mar.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2030-2060.mar.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2070-2100.mar.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2030-2060.mar.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2070-2100.mar.ts.txt"), by = c("lon", "lat")) %>%
setNames(c("lon", "lat", "hist_1850_1880", "hist_1985_2015","ssp245_2030_2060","ssp245_2070_2100","ssp370_2030_2060","ssp370_2070_2100","ssp585_2030_2060","ssp585_2070_2100"))
awi_mar_land <- merge(awi_mar, land_mask.df, by = c("lon","lat")) 
awi_mar_ipcc <- merge(awi_mar_land, ipcc_regions.df, by = c("lon","lat"))

write.table(awi_mar_ipcc, "Averages/ts/awi.mar.ts_ipcc.txt")
```

```{r awi-avr-dfs}
awi_avr <- merge(read.table("/bettik/crapartc/Averages/ts/awi.hist.1850-1880.avr.ts.txt"), read.table("/bettik/crapartc/Averages/ts/awi.hist.1985-2015.avr.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2030-2060.avr.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2070-2100.avr.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2030-2060.avr.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2070-2100.avr.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2030-2060.avr.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2070-2100.avr.ts.txt"), by = c("lon", "lat")) %>%
setNames(c("lon", "lat", "hist_1850_1880", "hist_1985_2015","ssp245_2030_2060","ssp245_2070_2100","ssp370_2030_2060","ssp370_2070_2100","ssp585_2030_2060","ssp585_2070_2100"))
awi_avr_land <- merge(awi_avr, land_mask.df, by = c("lon","lat")) 
awi_avr_ipcc <- merge(awi_avr_land, ipcc_regions.df, by = c("lon","lat"))

write.table(awi_avr_ipcc, "Averages/ts/awi.avr.ts_ipcc.txt")
```

```{r awi-may-dfs}
awi_may <- merge(read.table("/bettik/crapartc/Averages/ts/awi.hist.1850-1880.may.ts.txt"), read.table("/bettik/crapartc/Averages/ts/awi.hist.1985-2015.may.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2030-2060.may.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2070-2100.may.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2030-2060.may.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2070-2100.may.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2030-2060.may.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2070-2100.may.ts.txt"), by = c("lon", "lat")) %>%
setNames(c("lon", "lat", "hist_1850_1880", "hist_1985_2015","ssp245_2030_2060","ssp245_2070_2100","ssp370_2030_2060","ssp370_2070_2100","ssp585_2030_2060","ssp585_2070_2100"))
awi_may_land <- merge(awi_may, land_mask.df, by = c("lon","lat")) 
awi_may_ipcc <- merge(awi_may_land, ipcc_regions.df, by = c("lon","lat"))

write.table(awi_may_ipcc, "Averages/ts/awi.may.ts_ipcc.txt")
```

```{r awi-jun-dfs}
awi_jun <- merge(read.table("/bettik/crapartc/Averages/ts/awi.hist.1850-1880.jun.ts.txt"), read.table("/bettik/crapartc/Averages/ts/awi.hist.1985-2015.jun.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2030-2060.jun.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2070-2100.jun.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2030-2060.jun.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2070-2100.jun.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2030-2060.jun.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2070-2100.jun.ts.txt"), by = c("lon", "lat")) %>%
setNames(c("lon", "lat", "hist_1850_1880", "hist_1985_2015","ssp245_2030_2060","ssp245_2070_2100","ssp370_2030_2060","ssp370_2070_2100","ssp585_2030_2060","ssp585_2070_2100"))
awi_jun_land <- merge(awi_jun, land_mask.df, by = c("lon","lat")) 
awi_jun_ipcc <- merge(awi_jun_land, ipcc_regions.df, by = c("lon","lat"))

write.table(awi_jun_ipcc, "Averages/ts/awi.jun.ts_ipcc.txt")
```

```{r awi-jul-dfs}
awi_jul <- merge(read.table("/bettik/crapartc/Averages/ts/awi.hist.1850-1880.jul.ts.txt"), read.table("/bettik/crapartc/Averages/ts/awi.hist.1985-2015.jul.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2030-2060.jul.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2070-2100.jul.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2030-2060.jul.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2070-2100.jul.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2030-2060.jul.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2070-2100.jul.ts.txt"), by = c("lon", "lat")) %>%
setNames(c("lon", "lat", "hist_1850_1880", "hist_1985_2015","ssp245_2030_2060","ssp245_2070_2100","ssp370_2030_2060","ssp370_2070_2100","ssp585_2030_2060","ssp585_2070_2100"))
awi_jul_land <- merge(awi_jul, land_mask.df, by = c("lon","lat")) 
awi_jul_ipcc <- merge(awi_jul_land, ipcc_regions.df, by = c("lon","lat"))

write.table(awi_jul_ipcc, "Averages/ts/awi.jul.ts_ipcc.txt")
```

```{r awi-agu-dfs}
awi_agu <- merge(read.table("/bettik/crapartc/Averages/ts/awi.hist.1850-1880.agu.ts.txt"), read.table("/bettik/crapartc/Averages/ts/awi.hist.1985-2015.agu.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2030-2060.agu.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2070-2100.agu.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2030-2060.agu.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2070-2100.agu.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2030-2060.agu.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2070-2100.agu.ts.txt"), by = c("lon", "lat")) %>%
setNames(c("lon", "lat", "hist_1850_1880", "hist_1985_2015","ssp245_2030_2060","ssp245_2070_2100","ssp370_2030_2060","ssp370_2070_2100","ssp585_2030_2060","ssp585_2070_2100"))
awi_agu_land <- merge(awi_agu, land_mask.df, by = c("lon","lat")) 
awi_agu_ipcc <- merge(awi_agu_land, ipcc_regions.df, by = c("lon","lat"))

write.table(awi_agu_ipcc, "Averages/ts/awi.agu.ts_ipcc.txt")
```

```{r awi-sep-dfs}
awi_sep <- merge(read.table("/bettik/crapartc/Averages/ts/awi.hist.1850-1880.sep.ts.txt"), read.table("/bettik/crapartc/Averages/ts/awi.hist.1985-2015.sep.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2030-2060.sep.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2070-2100.sep.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2030-2060.sep.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2070-2100.sep.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2030-2060.sep.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2070-2100.sep.ts.txt"), by = c("lon", "lat")) %>%
setNames(c("lon", "lat", "hist_1850_1880", "hist_1985_2015","ssp245_2030_2060","ssp245_2070_2100","ssp370_2030_2060","ssp370_2070_2100","ssp585_2030_2060","ssp585_2070_2100"))
awi_sep_land <- merge(awi_sep, land_mask.df, by = c("lon","lat")) 
awi_sep_ipcc <- merge(awi_sep_land, ipcc_regions.df, by = c("lon","lat"))

write.table(awi_sep_ipcc, "Averages/ts/awi.sep.ts_ipcc.txt")
```

```{r awi-oct-dfs}
awi_oct <- merge(read.table("/bettik/crapartc/Averages/ts/awi.hist.1850-1880.oct.ts.txt"), read.table("/bettik/crapartc/Averages/ts/awi.hist.1985-2015.oct.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2030-2060.oct.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2070-2100.oct.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2030-2060.oct.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2070-2100.oct.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2030-2060.oct.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2070-2100.oct.ts.txt"), by = c("lon", "lat")) %>%
setNames(c("lon", "lat", "hist_1850_1880", "hist_1985_2015","ssp245_2030_2060","ssp245_2070_2100","ssp370_2030_2060","ssp370_2070_2100","ssp585_2030_2060","ssp585_2070_2100"))
awi_oct_land <- merge(awi_oct, land_mask.df, by = c("lon","lat")) 
awi_oct_ipcc <- merge(awi_oct_land, ipcc_regions.df, by = c("lon","lat"))

write.table(awi_oct_ipcc, "Averages/ts/awi.oct.ts_ipcc.txt")
```

```{r awi-nov-dfs}
awi_nov <- merge(read.table("/bettik/crapartc/Averages/ts/awi.hist.1850-1880.nov.ts.txt"), read.table("/bettik/crapartc/Averages/ts/awi.hist.1985-2015.nov.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2030-2060.nov.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2070-2100.nov.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2030-2060.nov.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2070-2100.nov.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2030-2060.nov.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2070-2100.nov.ts.txt"), by = c("lon", "lat")) %>%
setNames(c("lon", "lat", "hist_1850_1880", "hist_1985_2015","ssp245_2030_2060","ssp245_2070_2100","ssp370_2030_2060","ssp370_2070_2100","ssp585_2030_2060","ssp585_2070_2100"))
awi_nov_land <- merge(awi_nov, land_mask.df, by = c("lon","lat")) 
awi_nov_ipcc <- merge(awi_nov_land, ipcc_regions.df, by = c("lon","lat"))

write.table(awi_nov_ipcc, "Averages/ts/awi.nov.ts_ipcc.txt")
```

```{r awi-dec-dfs}
awi_dec <- merge(read.table("/bettik/crapartc/Averages/ts/awi.hist.1850-1880.dec.ts.txt"), read.table("/bettik/crapartc/Averages/ts/awi.hist.1985-2015.dec.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2030-2060.dec.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp245.2070-2100.dec.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2030-2060.dec.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp370.2070-2100.dec.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2030-2060.dec.ts.txt"), by = c("lon", "lat")) %>%
merge(read.table("/bettik/crapartc/Averages/ts/awi.ssp585.2070-2100.dec.ts.txt"), by = c("lon", "lat")) %>%
setNames(c("lon", "lat", "hist_1850_1880", "hist_1985_2015","ssp245_2030_2060","ssp245_2070_2100","ssp370_2030_2060","ssp370_2070_2100","ssp585_2030_2060","ssp585_2070_2100"))
awi_dec_land <- merge(awi_dec, land_mask.df, by = c("lon","lat")) 
awi_dec_ipcc <- merge(awi_dec_land, ipcc_regions.df, by = c("lon","lat"))

write.table(awi_dec_ipcc, "Averages/ts/awi.dec.ts_ipcc.txt")
```
